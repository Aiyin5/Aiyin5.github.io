<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.58" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://aiyin5.github.io/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html"><meta property="og:site_name" content="è‰¾å› çš„åšå®¢"><meta property="og:title" content="K8Sæ¨¡å¼"><meta property="og:description" content="K8Sæ¨¡å¼ 1.Introduction 1. ç®€ä»‹ In this introductory chapter, we set the scene for the rest of the book by explaining a few of the core Kubernetes concepts used for designing and implementing container basedcloud-native applications. Understanding these new abstractions, and the related principles and patterns from this book, are key to building distributed applications made automatable by cloud-native platforms. This chapter is not a prerequisite for understanding the patterns described later.Readers familiar with Kubernetes concepts can skip it and jump straight into the pattern category of interest."><meta property="og:type" content="article"><meta property="og:updated_time" content="2023-01-12T06:53:53.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="ç¿»è¯‘"><meta property="article:published_time" content="2022-01-05T00:00:00.000Z"><meta property="article:modified_time" content="2023-01-12T06:53:53.000Z"><title>K8Sæ¨¡å¼ | è‰¾å› çš„åšå®¢</title><meta name="description" content="K8Sæ¨¡å¼ 1.Introduction 1. ç®€ä»‹ In this introductory chapter, we set the scene for the rest of the book by explaining a few of the core Kubernetes concepts used for designing and implementing container basedcloud-native applications. Understanding these new abstractions, and the related principles and patterns from this book, are key to building distributed applications made automatable by cloud-native platforms. This chapter is not a prerequisite for understanding the patterns described later.Readers familiar with Kubernetes concepts can skip it and jump straight into the pattern category of interest.">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-4e49b06b.css" as="style"><link rel="stylesheet" href="/assets/style-4e49b06b.css">
    <link rel="modulepreload" href="/assets/app-3a4486d4.js"><link rel="modulepreload" href="/assets/framework-b9ac5585.js"><link rel="modulepreload" href="/assets/ç¬¬ä¸€éƒ¨åˆ†K8sç®€ä»‹.html-052f2d76.js"><link rel="modulepreload" href="/assets/ç¬¬ä¸€éƒ¨åˆ†K8sç®€ä»‹.html-37955edc.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="è‰¾å› çš„åšå®¢"><!----><span class="site-name hide-in-pad">è‰¾å› çš„åšå®¢</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!----><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="ä¸»é¡µ"><span class="icon iconfont icon-home"></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è‰¾å› çš„ä¸–ç•Œ"><span class="title"><span class="icon iconfont icon-discover"></span>è‰¾å› çš„ä¸–ç•Œ</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E8%89%BE%E5%9B%A0/%E5%85%B3%E4%BA%8E%E8%89%BE%E5%9B%A0.html" class="nav-link" aria-label="å…³äºè‰¾å› "><span class="icon iconfont icon-edit"></span>å…³äºè‰¾å› <!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ç”Ÿæ´»ä½“éªŒ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E8%89%BE%E5%9B%A0/%E7%94%9F%E6%B4%BB%E4%BD%93%E9%AA%8C/%E4%B8%8A%E6%B5%B7.html" class="nav-link" aria-label="ä¸Šæµ·"><span class="icon iconfont icon-edit"></span>ä¸Šæµ·<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E8%89%BE%E5%9B%A0/%E7%94%9F%E6%B4%BB%E4%BD%93%E9%AA%8C/%E6%9D%AD%E5%B7%9E.html" class="nav-link" aria-label="æ­å·"><span class="icon iconfont icon-edit"></span>æ­å·<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E8%89%BE%E5%9B%A0/%E7%94%9F%E6%B4%BB%E4%BD%93%E9%AA%8C/%E5%AE%89%E5%90%89.html" class="nav-link" aria-label="å®‰å‰"><span class="icon iconfont icon-edit"></span>å®‰å‰<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E8%89%BE%E5%9B%A0/%E7%94%9F%E6%B4%BB%E4%BD%93%E9%AA%8C/%E5%A4%A7%E7%90%86.html" class="nav-link" aria-label="å¤§ç†"><span class="icon iconfont icon-edit"></span>å¤§ç†<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>å…³äºå¨å¸ˆ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E8%89%BE%E5%9B%A0/%E5%85%B3%E4%BA%8E%E5%8E%A8%E5%B8%88/%E8%89%BE%E5%9B%A0%E5%AE%B6%E7%9A%84%E8%8F%9C%E8%B0%B1.html" class="nav-link" aria-label="è‰¾å› å®¶çš„èœè°±"><span class="icon iconfont icon-edit"></span>è‰¾å› å®¶çš„èœè°±<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E8%89%BE%E5%9B%A0/%E5%85%B3%E4%BA%8E%E5%8E%A8%E5%B8%88/%E8%89%BE%E5%9B%A0%E5%AE%B6%E7%9A%84%E7%94%9C%E5%93%81.html" class="nav-link" aria-label="è‰¾å› å®¶çš„ç”œå“"><span class="icon iconfont icon-edit"></span>è‰¾å› å®¶çš„ç”œå“<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>è§†é‡</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zh/posts/å…³äºè‰¾å› /è§†é‡/1" class="nav-link" aria-label="tobeContinue"><span class="icon iconfont icon-edit"></span>tobeContinue<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="é¡¹ç›®"><span class="title"><span class="icon iconfont icon-edit"></span>é¡¹ç›®</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/zh/posts/%E9%A1%B9%E7%9B%AE%E7%9B%B8%E5%85%B3/%E9%A3%8E%E6%8E%A7%E5%86%B3%E7%AD%96%E5%BC%95%E6%93%8E.html" class="nav-link" aria-label="é£æ§å†³ç­–å¼•æ“ç›¸å…³"><span class="icon iconfont icon-edit"></span>é£æ§å†³ç­–å¼•æ“ç›¸å…³<!----></a></li><li class="dropdown-item"><a href="/zh/posts/%E9%A1%B9%E7%9B%AE%E7%9B%B8%E5%85%B3/FreeBe%E7%9B%B8%E5%85%B3.html" class="nav-link" aria-label="FreeBeç›¸å…³"><span class="icon iconfont icon-edit"></span>FreeBeç›¸å…³<!----></a></li><li class="dropdown-item"><a href="/zh/posts/%E9%A1%B9%E7%9B%AE%E7%9B%B8%E5%85%B3/%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5%E5%8F%8A%E5%8D%9A%E5%AE%A2.html" class="nav-link" aria-label="ä¸ªäººä¸»é¡µåŠåšå®¢"><span class="icon iconfont icon-edit"></span>ä¸ªäººä¸»é¡µåŠåšå®¢<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æŠ€æœ¯"><span class="title"><span class="icon iconfont icon-edit"></span>æŠ€æœ¯</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>é¢˜è§£</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF/LeetCode%E9%A2%98%E8%A7%A3/LeetCode%E9%A2%98%E8%A7%A3.html" class="nav-link" aria-label="LeetCodeé¢˜è§£"><span class="icon iconfont icon-edit"></span>LeetCodeé¢˜è§£<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ç®—æ³•</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA%E6%95%B4%E7%90%86.html" class="nav-link" aria-label="å›¾è®ºæ•´ç†"><span class="icon iconfont icon-edit"></span>å›¾è®ºæ•´ç†<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF/%E7%AE%97%E6%B3%95/%E4%BA%8C%E5%88%86%E6%90%9C%E7%B4%A2%E8%BE%B9%E7%95%8C%E5%88%A4%E6%96%AD.html" class="nav-link" aria-label="äºŒåˆ†æœç´¢è¾¹ç•Œåˆ¤æ–­"><span class="icon iconfont icon-edit"></span>äºŒåˆ†æœç´¢è¾¹ç•Œåˆ¤æ–­<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF/%E7%AE%97%E6%B3%95/%E5%B9%B6%E6%9F%A5%E9%9B%86.html" class="nav-link" aria-label="å¹¶æŸ¥é›†"><span class="icon iconfont icon-edit"></span>å¹¶æŸ¥é›†<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>åç«¯</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF/%E5%90%8E%E7%AB%AF/java%E5%9F%BA%E7%A1%80.html" class="nav-link" aria-label="javaåŸºç¡€"><span class="icon iconfont icon-edit"></span>javaåŸºç¡€<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF/%E5%90%8E%E7%AB%AF/%E6%95%B0%E6%8D%AE%E5%BA%93.html" class="nav-link" aria-label="æ•°æ®åº“"><span class="icon iconfont icon-edit"></span>æ•°æ®åº“<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF/%E5%90%8E%E7%AB%AF/redis.html" class="nav-link" aria-label="redis"><span class="icon iconfont icon-edit"></span>redis<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF/%E5%90%8E%E7%AB%AF/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6.html" class="nav-link" aria-label="å¼€å‘æ¡†æ¶"><span class="icon iconfont icon-edit"></span>å¼€å‘æ¡†æ¶<!----></a></li><li class="dropdown-subitem"><a href="/zh/posts/%E5%85%B3%E4%BA%8E%E6%8A%80%E6%9C%AF/%E5%90%8E%E7%AB%AF/%E7%9F%A5%E8%AF%86%E9%93%BE%E6%8E%A5.html" class="nav-link" aria-label="çŸ¥è¯†é“¾æ¥"><span class="icon iconfont icon-edit"></span>çŸ¥è¯†é“¾æ¥<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ–‡ç« ç¿»è¯‘"><span class="title"><span class="icon iconfont icon-edit"></span>æ–‡ç« ç¿»è¯‘</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1.html" class="nav-link" aria-label="K8sæ¨¡å¼"><span class="icon iconfont icon-edit"></span>K8sæ¨¡å¼<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/about/About.html" class="nav-link" aria-label="å…³äº"><span class="icon iconfont icon-discover"></span>å…³äº<!----></a></div></nav><div class="nav-item"><a class="repo-link" href="https://github.com/Aiyin5/Aiyin5.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/" class="nav-link sidebar-link sidebar-page" aria-label="ä¸»é¡µ"><span class="icon iconfont icon-home"></span>ä¸»é¡µ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading active"><span class="icon iconfont icon-note"></span><span class="title">æ–‡ç« </span><!----></p><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">å…³äºæŠ€æœ¯</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">å…³äºè‰¾å› </span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">æ–‡ç« ç¿»è¯‘</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">K8sæ¨¡å¼</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1.html" class="nav-link sidebar-link sidebar-page" aria-label="K8sæ¨¡å¼ç¿»è¯‘"><span class="icon iconfont icon-page"></span>K8sæ¨¡å¼ç¿»è¯‘<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">K8såŸºç¡€æ¨¡å¼</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">K8sçš„ç®€ä»‹</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="K8Sæ¨¡å¼"><span class="icon iconfont icon-edit"></span>K8Sæ¨¡å¼<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-introduction" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.Introduction"><!---->1.Introduction<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-ç®€ä»‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1. ç®€ä»‹"><!---->1. ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-1-the-path-to-cloud-native" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.1 The Path to Cloud Native"><!---->1.1 The Path to Cloud Native<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-1-é€šå¾€äº‘åŸç”Ÿçš„é“è·¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.1 é€šå¾€äº‘åŸç”Ÿçš„é“è·¯"><!---->1.1 é€šå¾€äº‘åŸç”Ÿçš„é“è·¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-2-distributed-primitives" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.2 Distributed Primitives"><!---->1.2 Distributed Primitives<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-2-åˆ†å¸ƒå¼åŸè¯­" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.2 åˆ†å¸ƒå¼åŸè¯­"><!---->1.2 åˆ†å¸ƒå¼åŸè¯­<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-3-discussion" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.3 Discussion"><!---->1.3 Discussion<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-3-è®¨è®º" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.3 è®¨è®º"><!---->1.3 è®¨è®º<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul></section></li></ul></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">é¡¹ç›®ç›¸å…³</span><span class="arrow right"></span></button><!----></section></li></ul></section></li><li><!--[--><a href="/slides.html" class="nav-link sidebar-link sidebar-page" aria-label="Slide page"><span class="icon iconfont icon-slides"></span>Slide page<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-edit"></span>K8Sæ¨¡å¼</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="http://www.aiyin.xyz" target="_blank" rel="noopener noreferrer">è‰¾å› </a></span><span property="author" content="è‰¾å› "></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-01-05T00:00:00.000Z"></span><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="category-item category4 clickable" role="navigation">æŠ€æœ¯</span><span class="category-item category2 clickable" role="navigation">K8s</span><meta property="articleSection" content="æŠ€æœ¯,K8s"></span><span class="tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="tag-item tag-item1 clickable" role="navigation">ç¿»è¯‘</span><meta property="keywords" content="ç¿»è¯‘"></span><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 33 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT33M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-introduction" class="router-link-active router-link-exact-active toc-link level2">1.Introduction</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-ç®€ä»‹" class="router-link-active router-link-exact-active toc-link level2">1. ç®€ä»‹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-1-the-path-to-cloud-native" class="router-link-active router-link-exact-active toc-link level3">1.1 The Path to Cloud Native</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-1-é€šå¾€äº‘åŸç”Ÿçš„é“è·¯" class="router-link-active router-link-exact-active toc-link level3">1.1 é€šå¾€äº‘åŸç”Ÿçš„é“è·¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-2-distributed-primitives" class="router-link-active router-link-exact-active toc-link level3">1.2 Distributed Primitives</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-2-åˆ†å¸ƒå¼åŸè¯­" class="router-link-active router-link-exact-active toc-link level3">1.2 åˆ†å¸ƒå¼åŸè¯­</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-3-discussion" class="router-link-active router-link-exact-active toc-link level3">1.3 Discussion</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/posts/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/K8s%E6%A8%A1%E5%BC%8F/K8s%E7%9A%84%E7%AE%80%E4%BB%8B/%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86K8s%E7%AE%80%E4%BB%8B.html#_1-3-è®¨è®º" class="router-link-active router-link-exact-active toc-link level3">1.3 è®¨è®º</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="k8sæ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#k8sæ¨¡å¼" aria-hidden="true">#</a> K8Sæ¨¡å¼</h1><h2 id="_1-introduction" tabindex="-1"><a class="header-anchor" href="#_1-introduction" aria-hidden="true">#</a> 1.Introduction</h2><h2 id="_1-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_1-ç®€ä»‹" aria-hidden="true">#</a> 1. ç®€ä»‹</h2><p>In this introductory chapter, we set the scene for the rest of the book by explaining a few of the core Kubernetes concepts used for designing and implementing container basedcloud-native applications. Understanding these new abstractions, and the related principles and patterns from this book, are key to building distributed applications made automatable by cloud-native platforms. This chapter is not a prerequisite for understanding the patterns described later.Readers familiar with Kubernetes concepts can skip it and jump straight into the pattern category of interest.</p><p>åœ¨æœ¬ä»‹ç»æ€§ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è§£é‡Šä¸€äº›Kubernetesçš„æ ¸å¿ƒæ¦‚å¿µï¼Œè¿™äº›æ¦‚å¿µç”¨äºè®¾è®¡å’Œå®ç°åŸºäºå®¹å™¨çš„äº‘åŸç”Ÿåº”ç”¨ï¼Œä¸ºæœ¬ä¹¦çš„å…¶ä½™éƒ¨åˆ†å¥ å®šäº†åŸºç¡€ã€‚ç†è§£è¿™äº›æ–°çš„æŠ½è±¡ï¼Œä»¥åŠæœ¬ä¹¦ä¸­çš„ç›¸å…³åŸåˆ™å’Œæ¨¡å¼ï¼Œæ˜¯ä½¿ç”¨äº‘åŸç”Ÿå¹³å°è‡ªåŠ¨åŒ–æ„å»ºåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„å…³é”®ã€‚</p><p>æœ¬ç« ä¸æ˜¯ç†è§£åé¢ç« èŠ‚è®¾è®¡æ¨¡å¼çš„å…ˆå†³æ¡ä»¶ã€‚ç†Ÿæ‚‰Kubernetesæ¦‚å¿µçš„è¯»è€…å¯ä»¥è·³è¿‡æœ¬ç« ï¼Œç›´æ¥é˜…è¯»æ„Ÿå…´è¶£çš„ç« èŠ‚ã€‚</p><h3 id="_1-1-the-path-to-cloud-native" tabindex="-1"><a class="header-anchor" href="#_1-1-the-path-to-cloud-native" aria-hidden="true">#</a> 1.1 The Path to Cloud Native</h3><h3 id="_1-1-é€šå¾€äº‘åŸç”Ÿçš„é“è·¯" tabindex="-1"><a class="header-anchor" href="#_1-1-é€šå¾€äº‘åŸç”Ÿçš„é“è·¯" aria-hidden="true">#</a> 1.1 é€šå¾€äº‘åŸç”Ÿçš„é“è·¯</h3><p>The most popular application architecture on the cloud-native platforms such as Kubernetes is the microservices style. This software development technique tackles software complexity through modularization of business capabilities and trading development complexity for operational complexity.</p><p>Kubernetesç­‰äº‘åŸç”Ÿå¹³å°ä¸Šæœ€æµè¡Œçš„åº”ç”¨ç¨‹åºæ¶æ„æ˜¯å¾®æœåŠ¡é£æ ¼çš„ã€‚è¿™ç§å¾®æœåŠ¡é£æ ¼è½¯ä»¶å¼€å‘æŠ€æœ¯é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•æ¥è§£å†³è½¯ä»¶å¤æ‚æ€§é—®é¢˜</p><ul><li>å°†ä¸šåŠ¡å†…å®¹è¿›è¡Œæ¨¡å—åŒ–</li><li>ä½¿ç”¨å¼€å‘ä¸Šçš„å¤æ‚æ€§æ¢å–æ“ä½œå¤æ‚æ€§</li></ul><p>As part of the microservices movement, there is a significant amount of theory and supplemental techniques for creating microservices from scratch or for splitting monoliths into microservices. Most of these practices are based on the Domain-Driven Design book by Eric Evans (Addison-Wesley) and the concepts of bounded contexts and aggregates. Bounded contexts deal with large models by dividing them into different components, and aggregates help further to group bounded contexts into modules with defined transaction boundaries.</p><p>However, in addition to these business domain considerations, for every distributed systemâ€”whether it is based on microservices or notâ€”there are also numerous technical concerns around its organization,structure, and runtime behavior.</p><p>ä½œä¸ºå¾®æœåŠ¡è¿åŠ¨çš„ä¸€éƒ¨åˆ†ï¼Œæœ‰å¤§é‡çš„ç†è®ºå’Œè¡¥å……æŠ€æœ¯ç”¨äºä»å¤´å¼€å§‹åˆ›å»ºå¾®æœåŠ¡æˆ–å°†æ•´ä½“åº”ç”¨æ‹†åˆ†ä¸ºå¾®æœåŠ¡ã€‚è¿™äº›å®è·µå¤§å¤šåŸºäºEric Evansï¼ˆAddison Wesleyï¼‰çš„é¢†åŸŸé©±åŠ¨è®¾è®¡ä¹¦ä»¥åŠæœ‰ç•Œï¼ˆé™ç•Œï¼‰ä¸Šä¸‹æ–‡å’Œèšåˆçš„æ¦‚å¿µã€‚æœ‰ç•Œä¸Šä¸‹æ–‡é€šè¿‡å°†å¤§å‹æ¨¡å‹åˆ’åˆ†ä¸ºä¸åŒçš„ç»„ä»¶æ¥å¤„ç†å¤§å‹æ¨¡å‹ï¼Œèšåˆæœ‰åŠ©äºè¿›ä¸€æ­¥å°†æœ‰ç•Œä¸Šä¸‹æ–‡åˆ†ç»„ä¸ºå…·æœ‰å®šä¹‰äº‹åŠ¡è¾¹ç•Œçš„æ¨¡å—ã€‚</p><p>ç„¶è€Œï¼Œé™¤äº†è¿™äº›ä¸šåŠ¡é¢†åŸŸçš„è€ƒè™‘ä¹‹å¤–ï¼Œå¯¹äºæ¯ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæ— è®ºå®ƒæ˜¯å¦åŸºäºå¾®æœåŠ¡ï¼Œå®ƒçš„ç»„ç»‡ã€ç»“æ„å’Œè¿è¡Œæ—¶è¡Œä¸ºä¹Ÿæœ‰è®¸å¤šæŠ€æœ¯é—®é¢˜ã€‚</p><p>Containers and container orchestrators such as Kubernetes provide many new primitives and abstractions to address the concerns of distributed applications, and here we discuss the various options to consider when putting a distributed system into Kubernetes.</p><p>Kubernetesç­‰å®¹å™¨å’Œå®¹å™¨è°ƒåº¦å™¨æä¾›äº†è®¸å¤šæ–°çš„åŸè¯­ï¼ˆåŸå‹ï¼‰å’ŒæŠ½è±¡æ¥è§£å†³åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„é—®é¢˜ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®¨è®ºä½¿ç”¨Kubernetesåˆ›å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ—¶è¦è€ƒè™‘çš„å„ç§å› ç´ ã€‚</p><p>Throughout this book, we look at container and platform interactions by treating the containers as black boxes. However, we created this section to emphasize the importance of what goes into containers. Containers and cloud-native platforms bring tremendous benefits to your distributed applications, but if all you put into containers is rubbish, you will get distributed rubbish at scale. Figure 1-1 shows the mixture of the skills required for creating good cloud-native applications.</p><p>åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å°†å®¹å™¨è§†ä¸ºé»‘åŒ£å­æ¥ç ”ç©¶å®¹å™¨å’Œå¹³å°çš„äº¤äº’ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬åˆ›å»ºæœ¬èŠ‚æ˜¯ä¸ºäº†å¼ºè°ƒå…³äºå®¹å™¨å†…å®¹çš„é‡è¦æ€§ã€‚å®¹å™¨å’Œäº‘åŸç”Ÿå¹³å°åœ¨ä¸ºåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºå¸¦æ¥äº†å·¨å¤§çš„å¥½å¤„ï¼Œä½†æ˜¯å¦‚æœå®¹å™¨ä¸­æŠ•å…¥çš„åªæ˜¯åƒåœ¾ï¼Œé‚£ä¹ˆå°†å¾—åˆ°çš„æ˜¯å¤§è§„æ¨¡çš„åˆ†å¸ƒå¼åƒåœ¾ã€‚å›¾1-1æ˜¾ç¤ºäº†åˆ›å»ºè‰¯å¥½çš„äº‘åŸç”Ÿåº”ç”¨ç¨‹åºæ‰€éœ€çš„æŠ€èƒ½ç»„åˆã€‚<img src="https://cdn.nlark.com/yuque/0/2021/png/2466332/1633507758982-111d5750-675f-4ff9-a68c-b51e2523ccfe.png#clientId=u6d5596df-caa0-4&amp;from=paste&amp;height=545&amp;id=u2ed8fcfe&amp;margin=[object Object]&amp;name=image.png&amp;originHeight=545&amp;originWidth=650&amp;originalType=binary&amp;ratio=1&amp;size=55989&amp;status=done&amp;style=none&amp;taskId=u13e3b312-7d16-49ec-8203-0d4b7b6f047&amp;width=650" alt="image.png" loading="lazy"> Figure 1-1. The path to cloud native</p><p>At a high level, there are multiple abstraction levels in a cloud-native application that require different design considerations:</p><p>ä»æœ€é«˜å±‚æ¥çœ‹ï¼Œäº‘åŸç”Ÿåº”ç”¨ç¨‹åºä¸­æœ‰å¤šä¸ªæŠ½è±¡çº§åˆ«ï¼Œä¸åŒçš„æŠ½è±¡å±‚çº§éœ€è¦ä¸åŒçš„è®¾è®¡è€ƒè™‘ï¼š</p><ul><li>At the lowest code level, every variable you define, every method you create, and every class you decide to instantiate plays a role in the long-term maintenance of the application. No matter what container technology and orchestration platform you use, the development team and the artifacts they create will have the most impact. It is important to grow developers who strive to write clean code, have the right amount of automated tests, constantly refactor to improve code quality, and are software craftsmen at heart.</li><li>åœ¨é‡Œå±‚çš„çš„ä»£ç çº§åˆ«ä¸Šï¼Œä½ å®šä¹‰çš„æ¯ä¸ªå˜é‡ã€åˆ›å»ºçš„æ¯ä¸ªæ–¹æ³•ä»¥åŠä½ å†³å®šå®ä¾‹åŒ–çš„æ¯ä¸ªç±»éƒ½åœ¨åº”ç”¨ç¨‹åºçš„é•¿æœŸç»´æŠ¤ä¸­å‘æŒ¥ä½œç”¨ã€‚æ— è®ºä½ ä½¿ç”¨ä½•ç§å®¹å™¨æŠ€æœ¯å’Œç¼–æ’å¹³å°ï¼Œå¼€å‘å›¢é˜Ÿå’Œä»–ä»¬åˆ›å»ºçš„ç»„ä»¶éƒ½å°†äº§ç”Ÿæœ€å¤§çš„å½±å“ã€‚é‡è¦çš„æ˜¯è¦åŸ¹å…»é‚£äº›åŠªåŠ›ç¼–å†™å¹²å‡€ä»£ç ã€æ‹¥æœ‰é€‚å½“æ•°é‡çš„è‡ªåŠ¨åŒ–æµ‹è¯•ã€ä¸æ–­é‡æ„ä»¥æé«˜ä»£ç è´¨é‡ã€å¹¶ä¸”å†…å¿ƒæ˜¯è½¯ä»¶å·¥åŒ çš„å¼€å‘äººå‘˜ã€‚</li><li>Domain-Driven Design is about approaching software design from a business perspective with the intention of keeping the architecture as close to the real world as possible. This approach works best for object-oriented programming languages, but there are also other good ways to model and design software for real-world problems. A model with the right business and transaction boundaries, easy-to-consume interfaces, and rich APIs is the foundation for successful containerization and automation later.</li><li>é¢†åŸŸé©±åŠ¨è®¾è®¡æ˜¯ä»ä¸šåŠ¡çš„è§’åº¦è¿›è¡Œè½¯ä»¶è®¾è®¡ï¼Œç›®çš„æ˜¯ä½¿ä½“ç³»ç»“æ„å°½å¯èƒ½æ¥è¿‘çœŸå®ä¸–ç•Œã€‚è¿™ç§æ–¹æ³•æœ€é€‚ç”¨äºé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼Œä½†ä¹Ÿæœ‰å…¶ä»–å¾ˆå¥½çš„æ–¹æ³•å¯ä»¥ä¸ºå®é™…é—®é¢˜å»ºæ¨¡å’Œè®¾è®¡è½¯ä»¶ã€‚å…·æœ‰æ­£ç¡®çš„ä¸šåŠ¡å’Œäº‹åŠ¡è¾¹ç•Œã€æ˜“äºä½¿ç”¨æ¥å£å’Œä¸°å¯ŒAPIçš„æ¨¡å‹æ˜¯ä»¥åæˆåŠŸçš„å®¹å™¨åŒ–å’Œè‡ªåŠ¨åŒ–çš„åŸºç¡€ã€‚</li><li>The microservices architectural style very quickly evolved to become the norm,and it provides valuable principles and practices for designing changing distributed applications. Applying these principles lets you create implementations that are optimized for scale, resiliency, and pace of change, which are common requirements for any modern software today.</li><li>å¾®æœåŠ¡ä½“ç³»æ¶æ„é£æ ¼å¾ˆå¿«å‘å±•æˆä¸ºè§„èŒƒï¼Œå®ƒä¸ºè®¾è®¡ä¸æ–­å˜åŒ–çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºæä¾›äº†æœ‰ä»·å€¼çš„åŸåˆ™å’Œå®è·µã€‚åº”ç”¨è¿™äº›åŸåˆ™ï¼Œä½ å¯ä»¥åˆ›å»ºæ˜“äºæ‰©å±•ã€å…·æœ‰å¼¹æ€§å’Œé€‚åº”å¿«é€Ÿå˜åŒ–çš„åˆ†å¸ƒå¼è½¯ä»¶ï¼Œè¿™æ˜¯å½“ä»Šä»»ä½•ç°ä»£è½¯ä»¶çš„å¸¸è§éœ€æ±‚ã€‚</li><li>Containers were very quickly adopted as the standard way of packaging and running distributed applications. Creating modular, reusable containers that are good cloud-native citizens is another fundamental prerequisite. With a growing number of containers in every organization comes the need to manage them using more effective methods and tools. Cloud native is a relatively new term used to describe principles, patterns, and tools to automate containerized microservices at scale. We use cloud native interchangeably with Kubernetes, which is the most popular open source cloud-native platform available today.</li><li>å®¹å™¨å¾ˆå¿«æˆä¸ºæ‰“åŒ…å’Œè¿è¡Œåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„æ ‡å‡†æ–¹å¼ã€‚åˆ›å»ºæ¨¡å—åŒ–ã€å¯é‡ç”¨çš„å®¹å™¨ï¼Œä½¿å…¶æˆä¸ºä¼˜ç§€çš„äº‘åŸç”Ÿå…¬æ°‘ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªåŸºæœ¬å‰æã€‚éšç€æ¯ä¸ªç»„ç»‡ä¸­å®¹å™¨æ•°é‡çš„ä¸æ–­å¢åŠ ï¼Œéœ€è¦ä½¿ç”¨æ›´æœ‰æ•ˆçš„æ–¹æ³•å’Œå·¥å…·æ¥ç®¡ç†å®ƒä»¬ã€‚äº‘åŸç”Ÿæ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„æœ¯è¯­ï¼Œç”¨äºæè¿°å¤§è§„æ¨¡è‡ªåŠ¨åŒ–å®¹å™¨åŒ–å¾®æœåŠ¡çš„åŸåˆ™ã€æ¨¡å¼å’Œå·¥å…·ã€‚æˆ‘ä»¬å°†äº‘åŸç”Ÿä¸Kubernetesäº’æ¢ä½¿ç”¨ï¼ŒKubernetesæ˜¯ç›®å‰æœ€æµè¡Œçš„å¼€æºäº‘åŸç”Ÿå¹³å°ã€‚</li></ul><p>In this book, we are not covering clean code, domain-driven design, or microservices.We are focusing only on the patterns and practices addressing the concerns of the container orchestration. But for these patterns to be effective, your application needs to be designed well from the inside by applying clean code practices, domain-driven design, microservices patterns, and other relevant design techniques.</p><p>åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬ä¸æ¶‰åŠå¹²å‡€çš„ä»£ç ã€é¢†åŸŸé©±åŠ¨è®¾è®¡æˆ–å¾®æœåŠ¡ï¼Œæˆ‘ä»¬åªå…³æ³¨è§£å†³å®¹å™¨ç¼–æ’é—®é¢˜çš„æ¨¡å¼å’Œå®è·µã€‚ä½†æ˜¯ä¸ºäº†ä½¿è¿™äº›æ¨¡å¼æœ‰æ•ˆï¼Œä½ çš„åº”ç”¨ç¨‹åºéœ€è¦é€šè¿‡åº”ç”¨å¹²å‡€çš„ä»£ç å®è·µã€é¢†åŸŸé©±åŠ¨è®¾è®¡ã€å¾®æœåŠ¡æ¨¡å¼å’Œå…¶ä»–ç›¸å…³è®¾è®¡æŠ€æœ¯ä»å†…éƒ¨è¿›è¡Œè‰¯å¥½è®¾è®¡ã€‚</p><h3 id="_1-2-distributed-primitives" tabindex="-1"><a class="header-anchor" href="#_1-2-distributed-primitives" aria-hidden="true">#</a> 1.2 Distributed Primitives</h3><h3 id="_1-2-åˆ†å¸ƒå¼åŸè¯­" tabindex="-1"><a class="header-anchor" href="#_1-2-åˆ†å¸ƒå¼åŸè¯­" aria-hidden="true">#</a> 1.2 åˆ†å¸ƒå¼åŸè¯­</h3><!--ç™¾åº¦ç™¾ç§‘ä¸­åŸè¯­çš„å®šä¹‰ï¼šæ‰€è°“åŸè¯­ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç”±è‹¥å¹²æ¡æŒ‡ä»¤ç»„æˆçš„ç¨‹åºæ®µï¼Œç”¨æ¥å®ç°æŸä¸ªç‰¹å®šåŠŸèƒ½ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸å¯è¢«ä¸­æ–­ã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼ŒæŸäº›è¢«è¿›ç¨‹è°ƒç”¨çš„æ“ä½œï¼Œå¦‚é˜Ÿåˆ—æ“ä½œã€å¯¹ä¿¡å·é‡çš„æ“ä½œã€æ£€æŸ¥å¯åŠ¨å¤–è®¾æ“ä½œç­‰ï¼Œä¸€æ—¦å¼€å§‹æ‰§è¡Œï¼Œå°±ä¸èƒ½è¢«ä¸­æ–­ï¼Œå¦åˆ™å°±ä¼šå‡ºç°æ“ä½œé”™è¯¯ï¼Œé€ æˆç³»ç»Ÿæ··ä¹±ã€‚æ‰€ä»¥ï¼Œè¿™äº›æ“ä½œéƒ½è¦ç”¨åŸè¯­æ¥å®ç° åŸè¯­æ˜¯æ“ä½œç³»ç»Ÿæ ¸å¿ƒï¼ˆä¸æ˜¯ç”±è¿›ç¨‹ï¼Œè€Œæ˜¯ç”±ä¸€ç»„ç¨‹åºæ¨¡å—ç»„æˆï¼‰çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼Œå¹¶ä¸”å¸¸é©»å†…å­˜ï¼Œé€šå¸¸åœ¨ç®¡æ€ä¸‹æ‰§è¡Œã€‚åŸè¯­ä¸€æ—¦å¼€å§‹æ‰§è¡Œï¼Œå°±è¦è¿ç»­æ‰§è¡Œå®Œï¼Œä¸å…è®¸ä¸­æ–­ ã€‚--><!--è¿›ç¨‹å†…åŸè¯­ä¸åˆ†å¸ƒå¼åŸè¯­æœ‰ä¸€äº›å…±æ€§ï¼Œä½†å®ƒä»¬ä¹‹é—´ä¸å…·æœ‰ç›´æ¥çš„å¯æ¯”æ€§ã€‚å®ƒä»¬è¿è¡Œåœ¨ä¸åŒçš„æŠ½è±¡å±‚ä¹‹ä¸Šï¼Œæœ‰ä¸åŒçš„å‰ææ¡ä»¶ï¼Œå¹¶æä¾›äº†ä¸ä¸€æ ·çš„ä¿è¯ã€‚æ‰€ä»¥è¿™é‡Œçš„åˆ†å¸ƒå¼åŸè¯­åªæ˜¯ä¸€ç§ç±»æ¯”è¡Œä¸ºï¼Œå¹¶ä¸æ˜¯æŒ‡åˆ†å¸ƒå¼åŸè¯­ç­‰äºè¿›ç¨‹ä¸­çš„åŸè¯­--><p>To explain what we mean by new abstractions and primitives, here we compare them with the well-known object-oriented programming (OOP), and Java specifically. In the OOP universe, we have concepts such as class, object, package, inheritance,encapsulation, and polymorphism. Then the Java runtime provides specific features and guarantees on how it manages the lifecycle of our objects and the application as a whole.</p><p>ä¸ºäº†è§£é‡Šæ–°çš„æŠ½è±¡æ¦‚å¿µå’ŒåŸè¯­çš„å«ä¹‰ï¼Œè¿™é‡Œæˆ‘ä»¬å°†å®ƒä»¬ä¸è‘—åçš„é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰å’ŒJavaè¿›è¡Œæ¯”è¾ƒã€‚åœ¨OOPé¢†åŸŸä¸­ï¼Œæˆ‘ä»¬æœ‰ç±»ã€å¯¹è±¡ã€åŒ…ã€ç»§æ‰¿ã€å°è£…å’Œå¤šæ€æ€§ç­‰æ¦‚å¿µã€‚ç„¶åï¼ŒJavaè¿è¡Œæ—¶å°±å¦‚ä½•ç®¡ç†å¯¹è±¡å’Œæ•´ä¸ªåº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸæä¾›äº†ç‰¹å®šçš„åŠŸèƒ½å’Œä¿è¯ã€‚</p><p>The Java language and the Java Virtual Machine (JVM) provide local, in-process building blocks for creating applications. Kubernetes adds an entirely new dimension to this well-known mindset by offering a new set of distributed primitives and runtime for building distributed systems that spread across multiple nodes and processes.With Kubernetes at hand, we donâ€™t rely only on the local primitives to implement the whole application behavior.</p><p>Javaè¯­è¨€å’ŒJavaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸ºåˆ›å»ºåº”ç”¨ç¨‹åºæä¾›äº†æœ¬åœ°çš„è¿›ç¨‹å†…æ„å»ºå—ã€‚Kubernetesé€šè¿‡æä¾›ä¸€ç»„æ–°çš„åˆ†å¸ƒå¼åŸè¯­å’Œè¿è¡Œæ—¶æ¥æ„å»ºåˆ†å¸ƒåœ¨å¤šä¸ªèŠ‚ç‚¹å’Œè¿›ç¨‹ä¸Šçš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä¸ºè¿™ç§ä¼—æ‰€å‘¨çŸ¥çš„æ€ç»´æ–¹å¼å¢åŠ äº†ä¸€ä¸ªå…¨æ–°çš„ç»´åº¦ã€‚æœ‰äº†Kubernetesï¼Œæˆ‘ä»¬ä¸å†ä»…ä»…ä¾é æœ¬åœ°åŸè¯­æ¥å®ç°æ•´ä¸ªåº”ç”¨ç¨‹åºè¡Œä¸ºã€‚</p><p>We still need to use the object-oriented building blocks to create the components of the distributed application, but we can also use Kubernetes primitives for some of the application behaviors. Table 1-1 shows how various development concepts are realized differently with local and distributed primitives.</p><p>æˆ‘ä»¬ä»ç„¶éœ€è¦ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ„å»ºå—æ¥åˆ›å»ºåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„ç»„ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ä¸€äº›åº”ç”¨ç¨‹åºè¡Œä¸ºä½¿ç”¨KubernetesåŸè¯­ã€‚è¡¨1-1æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨æœ¬åœ°å’Œåˆ†å¸ƒå¼åŸè¯­ä»¥ä¸åŒæ–¹å¼å®ç°å„ç§å¼€å‘æ¦‚å¿µã€‚</p><p>Table 1-1. Local and distributed primitives</p><table><thead><tr><th>Concept</th><th>Local primitive</th><th>Distributed primitive</th></tr></thead><tbody><tr><td>Behavior encapsulation</td><td>Class</td><td>Container image</td></tr><tr><td>Behavior instance</td><td>Object</td><td>Container</td></tr><tr><td>Unit of reuse</td><td>.jar</td><td>Container image</td></tr><tr><td>Composition</td><td>Class A contains Class B</td><td>Sidecar pattern</td></tr><tr><td>Inheritance</td><td>Class A extends Class B</td><td>A containerâ€™s FROM parent image</td></tr><tr><td>Deployment unit</td><td>.jar/.war/.ear</td><td>Pod</td></tr><tr><td>Buildtime/Runtime isolation</td><td>Module, Package, Class</td><td>Namespace, Pod, container</td></tr><tr><td>Initialization preconditions</td><td>Constructor</td><td>Init container</td></tr><tr><td>Postinitialization trigger</td><td>Init-method</td><td>postStart</td></tr><tr><td>Predestroy trigger</td><td>Destroy-method</td><td>preStop</td></tr><tr><td>Cleanup procedure</td><td>finalize(), shutdown hook</td><td>Defer containera</td></tr><tr><td>Asynchronous &amp; parallel execution</td><td>ThreadPoolExecutor, ForkJoinPool</td><td>Job</td></tr><tr><td>Periodic task</td><td>Timer, ScheduledExecutorService</td><td>CronJob</td></tr><tr><td>Background task</td><td>Daemon thread</td><td>DaemonSet</td></tr><tr><td>Configuration management</td><td>System.getenv(), Properties</td><td>ConfigMap, Secret</td></tr></tbody></table><p>è¿™ä¸ªè¡¨æ ¼å†…å®¹ç†è§£è¾ƒå®¹æ˜“ï¼Œæš‚æ—¶ä¸ç¿»è¯‘ã€‚</p><p>The in-process primitives and the distributed primitives have commonalities, but they are not directly comparable and replaceable. They operate at different abstraction levels and have different preconditions and guarantees. Some primitives are supposed to be used together. For example, we still have to use classes to create objects and put them into container images. However, some other primitives such as Cronâ€Job in Kubernetes can replace the ExecutorService behavior in Java completely.</p><p>è¿›ç¨‹å†…åŸè¯­å’Œåˆ†å¸ƒå¼åŸè¯­å…·æœ‰å…±æ€§ï¼Œä½†å®ƒä»¬ä¸èƒ½ç›´æ¥è¿›è¡Œæ¯”è¾ƒå’Œæ›¿æ¢ã€‚å®ƒä»¬åœ¨ä¸åŒçš„æŠ½è±¡å±‚çº§ä¸Šè¿è¡Œï¼Œå¹¶å…·æœ‰ä¸åŒçš„å‰ææ¡ä»¶å’Œä¿è¯ã€‚ä¸€äº›åŸè¯­åº”è¯¥ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬ä»ç„¶å¿…é¡»ä½¿ç”¨ç±»æ¥åˆ›å»ºå¯¹è±¡å¹¶å°†å®ƒä»¬æ”¾å…¥å®¹å™¨å›¾åƒä¸­ã€‚ä½†æ˜¯ï¼ŒKubernetesä¸­çš„Cron-Jobç­‰å…¶ä»–åŸè¯­å¯ä»¥å®Œå…¨æ›¿ä»£Javaä¸­çš„ExecutorServiceè¡Œä¸ºã€‚</p><p>Next, letâ€™s see a few distributed abstractions and primitives from Kubernetes that are especially interesting for application developers.</p><p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹Kubernetesçš„ä¸€äº›åˆ†å¸ƒå¼æŠ½è±¡å’ŒåŸè¯­ï¼Œå®ƒä»¬å¯¹åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜æ¥è¯´ç‰¹åˆ«æœ‰è¶£ã€‚</p><h4 id="_1-2-1-containers" tabindex="-1"><a class="header-anchor" href="#_1-2-1-containers" aria-hidden="true">#</a> 1.2.1 Containers</h4><h4 id="_1-2-1-å®¹å™¨" tabindex="-1"><a class="header-anchor" href="#_1-2-1-å®¹å™¨" aria-hidden="true">#</a> 1.2.1 å®¹å™¨</h4><p>Containers are the building blocks for Kubernetes-based cloud-native applications. If we make a comparison with OOP and Java, container images are like classes, and containers are like objects.</p><p>The same way we can extend classes to reuse and alter behavior, we can have container images that extend other container images to reuse and alter behavior.</p><p>The same way we can do object composition and use functionality, we can do container compositions by putting containers into a Pod and using collaborating containers.</p><p>åœ¨åŸºäºKubernetesçš„äº‘åŸç”Ÿåº”ç”¨ç¨‹åºä¸­ï¼Œå®¹å™¨å°±æ˜¯æ„å»ºå—ã€‚å¦‚æœæˆ‘ä»¬ä¸OOPå’ŒJavaè¿›è¡Œæ¯”è¾ƒï¼Œé‚£ä¹ˆå®¹å™¨é•œåƒå¯¹åº”çš„æ˜¯ç±»ï¼Œå®¹å™¨å¯¹åº”çš„æ˜¯å¯¹è±¡ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æ‰©å±•ç±»æ¥å®ç°ç±»çš„å¤ç”¨å’Œå¤šæ€ï¼ˆæ”¹å˜è¡Œä¸ºï¼‰ï¼ŒåŒæ ·çš„æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®¹å™¨é•œåƒæ¥æ‰©å±•å…¶ä»–å®¹å™¨é•œåƒå®ç°é•œåƒçš„é‡ç”¨å’Œæ”¹å˜è¡Œä¸ºã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•è¿›è¡Œå¯¹è±¡ç»„åˆå’Œä½¿ç”¨åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å®¹å™¨æ”¾å…¥ä¸€ä¸ªPodå¹¶ä½¿ç”¨åä½œå®¹å™¨æ¥è¿›è¡Œå®¹å™¨ç»„åˆã€‚</p><p>If we continue the comparison, Kubernetes would be like the JVM but spread over multiple hosts, and would be responsible for running and managing the containers.</p><p>å¦‚æœæˆ‘ä»¬ç»§ç»­æ¯”è¾ƒï¼ŒKuberneteså°†ç±»ä¼¼äºJVMï¼Œä½†åˆ†å¸ƒåœ¨å¤šä¸ªä¸»æœºä¸Šï¼Œå¹¶è´Ÿè´£è¿è¡Œå’Œç®¡ç†å®¹å™¨ã€‚</p><p>Init containers would be something like object constructors;</p><p>DaemonSets would be similar to daemon threads that run in the background (like the Java Garbage Collector,for example).</p><p>A Pod would be something similar to an Inversion of Control (IoC) context (Spring Framework, for example), where multiple running objects share a managed lifecycle and can access each other directly.</p><p>åˆå§‹åŒ–å®¹å™¨ç±»ä¼¼äºå¯¹è±¡æ„é€ å‡½æ•°ï¼›</p><p>å®ˆæŠ¤ç¨‹åºé›†ç±»ä¼¼äºåå°è¿è¡Œçš„å®ˆæŠ¤ç¨‹åºçº¿ç¨‹ï¼ˆä¾‹å¦‚Javaåƒåœ¾æ”¶é›†å™¨ï¼‰ã€‚</p><p>Podç±»ä¼¼äºæ§åˆ¶åè½¬ï¼ˆInversion of Controlï¼ŒIoCï¼‰ä¸­çš„ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚Spring Frameworkï¼‰ï¼Œåœ¨è¯¥ä¸Šä¸‹æ–‡ä¸­ï¼Œå¤šä¸ªè¿è¡Œçš„å¯¹è±¡å…±äº«ä¸€ä¸ªæ‰˜ç®¡ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥è®¿é—®å½¼æ­¤ã€‚</p><p>The parallel doesnâ€™t go much further, but the point is that containers play a fundamental role in Kubernetes, and creating modularized, reusable, single-purpose container images is fundamental to the long-term success of any project and even the containersâ€™ ecosystem as a whole. Apart from the technical characteristics of a container image that provide packaging and isolation, what does a container represent and what is its purpose in the context of a distributed application? Here are a few suggestions on how to look at containers:</p><p>è¿™ç§å¹¶è¡Œçš„ç›¸å¯¹æ€§æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œä½†æ˜¯å…³é”®çš„æ˜¯å®¹å™¨åœ¨Kubernetesä¸­èµ·ç€çš„åŸºç¡€æ€§ä½œç”¨ï¼Œå› ä¸ºåˆ›å»ºæ¨¡å—åŒ–ã€å¯é‡ç”¨ã€å•ç”¨é€”çš„å®¹å™¨é•œåƒå¯¹äºä»»ä½•é¡¹ç›®ä¹ƒè‡³æ•´ä¸ªå®¹å™¨ç”Ÿæ€ç³»ç»Ÿçš„é•¿æœŸæˆåŠŸè‡³å…³é‡è¦ã€‚å®¹å™¨é•œåƒé™¤äº†æä¾›æ‰“åŒ…å’Œéš”ç¦»çš„æŠ€æœ¯ç‰¹å¾å¤–ï¼Œå®¹å™¨ä»£è¡¨ä»€ä¹ˆï¼Ÿåœ¨åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå®¹å™¨çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿä»¥ä¸‹æ˜¯ä¸€äº›å…³äºå¦‚ä½•çœ‹å¾…å®¹å™¨çš„å»ºè®®ï¼š</p><ul><li>A container image is the unit of functionality that addresses a single concern.</li><li>å®¹å™¨é•œåƒæ˜¯è§£å†³å•ä¸ªé—®é¢˜çš„åŠŸèƒ½å•å…ƒã€‚</li><li>A container image is owned by one team and has a release cycle.</li><li>å®¹å™¨é•œåƒç”±ä¸€ä¸ªå›¢é˜Ÿæ‹¥æœ‰ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªå‘å¸ƒå‘¨æœŸã€‚</li><li>A container image is self-contained and defines and carries its runtime dependencies.</li><li>å®¹å™¨é•œåƒæ˜¯è‡ªåŒ…å«çš„ï¼Œå®šä¹‰å¹¶æºå¸¦å…¶è¿è¡Œæ—¶ä¾èµ–é¡¹ã€‚</li><li>A container image is immutable, and once it is built, it does not change; it is configured.</li><li>å®¹å™¨é•œåƒæ˜¯ä¸å¯å˜çš„ï¼Œä¸€æ—¦æ„å»ºï¼Œå®ƒå°±ä¸ä¼šæ›´æ”¹ï¼›å·²ç»è¢«é…ç½®ã€‚</li><li>A container image has defined runtime dependencies and resource requirements.</li><li>å®¹å™¨é•œåƒå®šä¹‰äº†è¿è¡Œæ—¶ä¾èµ–é¡¹å’Œèµ„æºéœ€æ±‚ã€‚</li><li>A container image has well-defined APIs to expose its functionality.</li><li>å®¹å™¨é•œåƒå…·æœ‰å®šä¹‰æ¸…æ™°çš„APIç”¨æ¥å…¬å¼€å…¶åŠŸèƒ½ã€‚</li><li>A container runs typically as a single Unix process.</li><li>å®¹å™¨é€šå¸¸ä½œä¸ºå•ä¸ªUnixè¿›ç¨‹è¿è¡Œã€‚</li><li>A container is disposable and safe to scale up or down at any moment.</li><li>å®¹å™¨æ˜¯æ˜“äºæ›´æ–°ï¼ˆçŸ­æš‚ï¼‰çš„ï¼Œå¯ä»¥éšæ—¶æ”¾å¤§æˆ–ç¼©å°ã€‚</li></ul><p>In addition to all these characteristics, a proper container image is modular. It is parameterized and created for reuse in the different environments it is going to run. But it is also parameterized for its various use cases.</p><p>Having small, modular, and reusable container images leads to the creation of more specialized and stable container images in the long term, similar to a great reusable library in the programming language world.</p><p>é™¤äº†æ‰€æœ‰è¿™äº›ç‰¹æ€§ä¹‹å¤–ï¼Œå®¹å™¨é•œåƒä¹Ÿæ˜¯æ¨¡å—åŒ–çš„ã€‚å®ƒè¢«å‚æ•°åŒ–å¹¶åˆ›å»ºï¼Œä»¥ä¾¿åœ¨å°†è¦è¿è¡Œçš„ä¸åŒç¯å¢ƒä¸­é‡ç”¨ã€‚åŒæ—¶å®ƒçš„å‚æ•°åŒ–ä¹Ÿé€‚åº”å„ç§ä¸åŒçš„ç”¨ä¾‹ã€‚</p><p>æ‹¥æœ‰å°çš„ã€æ¨¡å—åŒ–çš„ã€å¯é‡ç”¨çš„å®¹å™¨é•œåƒå°†ä¼šå¯¹é•¿æœŸåˆ›å»ºæ›´ä¸“ä¸šã€æ›´ç¨³å®šçš„å®¹å™¨é•œåƒæœ‰å¸®åŠ©ï¼Œç±»ä¼¼äºç¼–ç¨‹è¯­è¨€ä¸–ç•Œä¸­çš„å¤§å‹å¯é‡ç”¨åº“ã€‚</p><h4 id="_1-2-2-pods" tabindex="-1"><a class="header-anchor" href="#_1-2-2-pods" aria-hidden="true">#</a> 1.2.2 Pods</h4><h4 id="_1-2-2-pods-åˆ†ç¦»èˆ±ã€ä¸å¤ªå¥½ç¿»è¯‘-ç›´æ¥ä½¿ç”¨pods" tabindex="-1"><a class="header-anchor" href="#_1-2-2-pods-åˆ†ç¦»èˆ±ã€ä¸å¤ªå¥½ç¿»è¯‘-ç›´æ¥ä½¿ç”¨pods" aria-hidden="true">#</a> 1.2.2 Podsï¼ˆåˆ†ç¦»èˆ±ã€ä¸å¤ªå¥½ç¿»è¯‘ï¼Œç›´æ¥ä½¿ç”¨Podsï¼‰</h4><p>Looking at the characteristics of containers, we can see that they are a perfect match for implementing the microservices principles. A container image provides a single unit of functionality, belongs to a single team, has an independent release cycle, and provides deployment and runtime isolation. Most of the time, one microservice corresponds to one container image.</p><p>çœ‹å®Œå®¹å™¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä»¬å’Œå®ç°å¾®æœåŠ¡åŸåˆ™çš„å®Œç¾åŒ¹é…ã€‚å®¹å™¨æ˜ åƒæä¾›å•ä¸ªåŠŸèƒ½å•å…ƒï¼Œå±äºå•ä¸ªå›¢é˜Ÿï¼Œå…·æœ‰ç‹¬ç«‹çš„å‘å¸ƒå‘¨æœŸï¼Œå¹¶æä¾›éƒ¨ç½²å’Œè¿è¡Œæ—¶éš”ç¦»ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå¾®æœåŠ¡å¯¹åº”ä¸€ä¸ªå®¹å™¨é•œåƒã€‚</p><p>However, most cloud-native platforms offer another primitive for managing the lifecycle of a group of containersâ€”in Kubernetes it is called a Pod.</p><p>ç„¶è€Œï¼Œå¤§å¤šæ•°äº‘åŸç”Ÿå¹³å°æä¾›äº†å¦ä¸€ç§åŸè¯­æ¥ç®¡ç†ä¸€ç»„å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨Kubernetesä¸­ç§°ä¸ºPodã€‚</p><p>A Pod is an atomic unit of scheduling, deployment, and runtime isolation for a group of containers. All containers in a Pod are always scheduled to the same host, deployed together whether for scaling or host migration purposes, and can also share filesystem, networking, and process namespaces. This joint lifecycle allows the containers in a Pod to interact with each other over the filesystem or through networking via localhost or host interprocess communication mechanisms if desired (for performance reasons, for example).</p><p>Podæ˜¯ä¸€ç»„å®¹å™¨çš„è°ƒåº¦ã€éƒ¨ç½²å’Œè¿è¡Œæ—¶éš”ç¦»çš„åŸå­å•å…ƒã€‚Podä¸­çš„æ‰€æœ‰å®¹å™¨å§‹ç»ˆè°ƒåº¦åˆ°åŒä¸€å°ä¸»æœºï¼Œéƒ½ä¸€èµ·éƒ¨ç½²ï¼Œæ— è®ºæ˜¯ä¸ºäº†æ‰©å±•è¿˜æ˜¯ä¸ºäº†ä¸»æœºè¿ç§»ï¼Œå¹¶ä¸”è¿˜å¯ä»¥å…±äº«æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œå’Œè¿›ç¨‹åç§°ç©ºé—´ã€‚è¿™ç§è”åˆç”Ÿå‘½å‘¨æœŸå…è®¸Podä¸­çš„å®¹å™¨é€šè¿‡æ–‡ä»¶ç³»ç»Ÿæˆ–é€šè¿‡æœ¬åœ°ä¸»æœºæˆ–ä¸»æœºè¿›ç¨‹é—´é€šä¿¡æœºåˆ¶è¿›è¡Œç½‘ç»œäº¤äº’ï¼ˆä¾‹å¦‚ï¼Œå‡ºäºæ€§èƒ½åŸå› ï¼‰ã€‚</p><p>As you can see in Figure 1-2, at the development and build time, a microservice corresponds to a container image that one team develops and releases. But at runtime, a microservice is represented by a Pod, which is the unit of deployment, placement, and scaling. The only way to run a containerâ€”whether for scale or migrationâ€”is through the Pod abstraction.</p><p>Sometimes a Pod contains more than one container.One such example is when a containerized microservice uses a helper container at runtime, as Chapter 15, Sidecar demonstrates later.</p><p>å¦‚å›¾1-2æ‰€ç¤ºï¼Œåœ¨å¼€å‘å’Œæ„å»ºæ—¶ï¼Œæ¯ä¸ªå¾®æœåŠ¡åº”ç”¨å¯¹åº”ç€å›¢é˜Ÿå¼€å‘å’Œå‘å¸ƒçš„ä¸€ä¸ªå®¹å™¨é•œåƒã€‚ä½†åœ¨è¿è¡Œæ—¶ï¼Œå¾®æœåŠ¡ç”±ä¸€ä¸ªPodè¡¨ç¤ºï¼ŒPodæ˜¯éƒ¨ç½²ã€æ”¾ç½®å’Œæ‰©å±•çš„å•å…ƒã€‚</p><p>è¿è¡Œå®¹å™¨ï¼ˆæ— è®ºæ˜¯ç”¨äºæ‰©å±•è¿˜æ˜¯è¿ç§»ï¼‰çš„å”¯ä¸€æ–¹æ³•æ˜¯é€šè¿‡Podå®ç°ã€‚æœ‰æ—¶ä¸€ä¸ªPodåŒ…å«å¤šä¸ªå®¹å™¨ï¼Œä¾‹å¦‚å½“ä¸€ä¸ªå®¹å™¨åŒ–çš„å¾®æœåŠ¡åœ¨è¿è¡Œæ—¶ä½¿ç”¨äº†ä¸€ä¸ªåŠ©æ‰‹å®¹å™¨ï¼Œåœ¨ç¬¬15ç« ä¸­ï¼ŒSidecarå°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2466332/1633507821552-547a5fcd-196c-4c6f-b12b-ab642225d645.png#clientId=u6d5596df-caa0-4&amp;from=paste&amp;height=461&amp;id=u78147ea9&amp;margin=[object Object]&amp;name=image.png&amp;originHeight=461&amp;originWidth=710&amp;originalType=binary&amp;ratio=1&amp;size=45186&amp;status=done&amp;style=none&amp;taskId=u56196258-2c18-4beb-b05f-1c0c6c307a9&amp;width=710" alt="image.png" loading="lazy"> Figure 1-2. A Pod as the deployment and management unit</p><p>Containers and Pods and their unique characteristics offer a new set of patterns and principles for designing microservices-based applications. We looked at some of the characteristics of well-designed containers; now letâ€™s look at some of the characteristics of a Pod:</p><p>å®¹å™¨å’ŒpodåŠå…¶ç‹¬ç‰¹çš„ç‰¹æ€§ä¸ºè®¾è®¡åŸºäºå¾®æœåŠ¡çš„åº”ç”¨ç¨‹åºæä¾›äº†ä¸€å¥—æ–°çš„æ¨¡å¼å’ŒåŸåˆ™ã€‚æˆ‘ä»¬ç ”ç©¶äº†ç²¾å¿ƒè®¾è®¡çš„å®¹å™¨çš„ä¸€äº›ç‰¹æ€§ï¼›ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹Podçš„ä¸€äº›ç‰¹æ€§ï¼š</p><ul><li>A Pod is the atomic unit of scheduling. That means the scheduler tries to find a host that satisfies the requirements of all containers that belong to the Pod (there are some specifics around init containers, which we cover in Chapter 14, Init Container). If you create a Pod with many containers, the scheduler needs to find a host that has enough resources to satisfy all container demands combined. This scheduling process is described in Chapter 6, Automated Placement.</li><li>Podæ˜¯è°ƒåº¦çš„åŸå­å•å…ƒã€‚è¿™æ„å‘³ç€åˆ†é…èµ„æºçš„æ—¶å€™ï¼Œè°ƒåº¦å™¨è¯•å›¾æ‰¾åˆ°ä¸€å°ä¸»æœºï¼Œè¿™å°ä¸»æœºèƒ½æ»¡è¶³Podä¸­æ‰€æœ‰å®¹å™¨çš„éœ€æ±‚ï¼ˆåˆå§‹åŒ–å®¹å™¨æœ‰ä¸€äº›ç»†èŠ‚ï¼Œæˆ‘ä»¬å°†åœ¨ç¬¬14ç« åˆå§‹åŒ–å®¹å™¨ä¸­ä»‹ç»ï¼‰ã€‚å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«è®¸å¤šå®¹å™¨çš„Podï¼Œé‚£ä¹ˆè°ƒåº¦å™¨éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæœ‰è¶³å¤Ÿèµ„æºæ»¡è¶³æ‰€æœ‰å®¹å™¨éœ€æ±‚çš„ä¸»æœºã€‚è¯¥è°ƒåº¦è¿‡ç¨‹åœ¨ç¬¬6ç« â€œè‡ªåŠ¨å¸ƒå±€â€ä¸­æè¿°ã€‚ï¼ˆè¿™é‡Œæ„Ÿè§‰é‡å¤äº†ï¼Ÿï¼‰</li><li>A Pod ensures colocation of containers. Thanks to the colocation, containers in the same Pod have additional means to interact with each other.The most common ways for communication include using a shared local filesystem for exchanging data or using the localhost network interface, or some host interprocess communication (IPC) mechanism for high-performance interactions.</li><li>ä¸€ä¸ªPodç¡®ä¿äº†è¿™ä¸ªPodä¸­æ‰€æœ‰å®¹å™¨åœ¨åŒä¸€å°ä¸»æœºã€‚å¤šäºäº†è¿™ç§å…±å®šä½ï¼ŒåŒä¸€ä¸ªPodä¸­çš„å®¹å™¨æœ‰äº†é¢å¤–ç›¸äº’ä½œç”¨çš„æ–¹å¼ã€‚æœ€å¸¸è§çš„é€šä¿¡æ–¹å¼åŒ…æ‹¬ä½¿ç”¨å…±äº«æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿäº¤æ¢æ•°æ®ï¼Œæˆ–ä½¿ç”¨æœ¬åœ°ä¸»æœºç½‘ç»œæ¥å£ï¼Œæˆ–ä½¿ç”¨æŸäº›ä¸»æœºè¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰æœºåˆ¶è¿›è¡Œé«˜æ€§èƒ½äº¤äº’ã€‚</li><li>A Pod has an IP address, name, and port range that are shared by all containers belonging to it. That means containers in the same Pod have to be carefully configured to avoid port clashes, in the same way that parallel running Unix processes have to take care when sharing the networking space on a host.</li><li>Podå…·æœ‰IPåœ°å€ã€åç§°å’Œç«¯å£èŒƒå›´ï¼Œæ‰€æœ‰å±äºå®ƒçš„å®¹å™¨éƒ½å…±äº«è¿™äº›åœ°å€ã€åç§°å’Œç«¯å£èŒƒå›´ã€‚è¿™æ„å‘³ç€å¿…é¡»ä»”ç»†é…ç½®åŒä¸€Podä¸­çš„å®¹å™¨ä»¥é¿å…ç«¯å£å†²çªï¼Œå°±åƒå¹¶è¡Œè¿è¡Œçš„Unixè¿›ç¨‹åœ¨å…±äº«ä¸»æœºä¸Šçš„ç½‘ç»œç©ºé—´æ—¶å¿…é¡»å°å¿ƒä¸€æ ·ã€‚</li></ul><p>A Pod is the atom of Kubernetes where your application lives, but you donâ€™t access Pods directlyâ€”that is where Services enter the scene.</p><p>Podå°±åƒæ˜¯Kubernetesï¼ˆäº‘åŸç”Ÿå¹³å°ï¼‰ä¸Šçš„åŸå­ï¼Œä½ çš„åº”ç”¨ç¨‹åºå°±è¿è¡Œåœ¨ä¸Šé¢ï¼Œä½†ä½ ä¸èƒ½ç›´æ¥è®¿é—®Podï¼Œä½†æ˜¯Podæ­£æ˜¯æœåŠ¡çš„å…¥å£ã€‚</p><h4 id="_1-2-3-services" tabindex="-1"><a class="header-anchor" href="#_1-2-3-services" aria-hidden="true">#</a> 1.2.3 Services</h4><h4 id="_1-2-3-æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_1-2-3-æœåŠ¡" aria-hidden="true">#</a> 1.2.3 æœåŠ¡</h4><p>Pods are ephemeralâ€”they can come and go at any time for all sort of reasons such as scaling up and down, failing container health checks, and node migrations. A Pod IP address is known only after it is scheduled and started on a node. A Pod can be rescheduled to a different node if the existing node it is running on is no longer healthy. All that means is the Podâ€™s network address may change over the life of an application, and there is a need for another primitive for discovery and load balancing.</p><p>PODæ˜¯çŸ­æš‚çš„ï¼Œå®ƒä»¬å¯ä»¥åœ¨ä»»ä½•æ—¶å€™æ¥æ¥å»å»ï¼ˆå…³é—­å’Œå¯åŠ¨ï¼‰ï¼ŒåŸå› æœ‰å„ç§å„æ ·ï¼Œæ¯”å¦‚å¼¹æ€§ä¼¸ç¼©ã€å®¹å™¨å¥åº·æ£€æŸ¥å¤±è´¥å’ŒèŠ‚ç‚¹è¿ç§»ã€‚Podçš„IPåœ°å€åªæœ‰åœ¨èŠ‚ç‚¹ä¸Šè°ƒåº¦å’Œå¯åŠ¨åæ‰çŸ¥é“ã€‚å¦‚æœPodè¿è¡Œçš„ç°æœ‰èŠ‚ç‚¹ä¸å†æ­£å¸¸ï¼Œåˆ™å¯ä»¥å°†Podé‡æ–°è°ƒåº¦åˆ°å…¶ä»–èŠ‚ç‚¹ã€‚è¿™æ„å‘³ç€Podçš„ç½‘ç»œåœ°å€å¯èƒ½ä¼šåœ¨åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå†…å‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤éœ€è¦å¦ä¸€ç§åŸè¯­æ¥è¿›è¡Œå‘ç°å’Œè´Ÿè½½å¹³è¡¡ã€‚</p><p>Thatâ€™s where the Kubernetes Services come into play. The Service is another simple but powerful Kubernetes abstraction that binds the Service name to an IP address and port number permanently. So a Service represents a named entry point for accessing an application. In the most common scenario, the Service serves as the entry point for a set of Pods, but that might not always be the case. The Service is a generic primitive, and it may also point to functionality provided outside the Kubernetes cluster. As such, the Service primitive can be used for Service discovery and load balancing, and allows altering implementations and scaling without affecting Service consumers. We explain Services in detail in Chapter 12, Service Discovery.</p><p>è¿™å°±æ˜¯KubernetesæœåŠ¡å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚è¯¥æœåŠ¡æ˜¯å¦ä¸€ä¸ªç®€å•ä½†åŠŸèƒ½å¼ºå¤§çš„KubernetesæŠ½è±¡ï¼Œå®ƒå°†æœåŠ¡åç§°æ°¸ä¹…ç»‘å®šåˆ°IPåœ°å€å’Œç«¯å£å·ã€‚å› æ­¤ï¼ŒæœåŠ¡ä»£è¡¨ç”¨äºè®¿é—®åº”ç”¨ç¨‹åºçš„å‘½åå…¥å£ç‚¹ã€‚åœ¨æœ€å¸¸è§çš„åœºæ™¯ä¸­ï¼ŒæœåŠ¡å……å½“ä¸€ç»„podçš„å…¥å£ç‚¹ï¼Œä½†æƒ…å†µå¯èƒ½å¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚è¯¥æœåŠ¡æ˜¯ä¸€ä¸ªé€šç”¨åŸè¯­ï¼Œå®ƒè¿˜å¯ä»¥æŒ‡å‘Kubernetesé›†ç¾¤å¤–éƒ¨æä¾›çš„åŠŸèƒ½ã€‚å› æ­¤ï¼ŒæœåŠ¡åŸè¯­å¯ç”¨äºæœåŠ¡å‘ç°å’Œè´Ÿè½½å¹³è¡¡ï¼Œå¹¶å…è®¸åœ¨ä¸å½±å“æœåŠ¡ä½¿ç”¨è€…çš„æƒ…å†µä¸‹æ›´æ”¹å®ç°å’Œæ‰©å±•ã€‚æˆ‘ä»¬å°†åœ¨ç¬¬12ç« â€œæœåŠ¡å‘ç°â€ä¸­è¯¦ç»†è§£é‡ŠæœåŠ¡ã€‚</p><h4 id="_1-2-4-labels" tabindex="-1"><a class="header-anchor" href="#_1-2-4-labels" aria-hidden="true">#</a> 1.2.4 Labels</h4><h4 id="_1-2-4æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#_1-2-4æ ‡ç­¾" aria-hidden="true">#</a> 1.2.4æ ‡ç­¾</h4><p>We have seen that a microservice is a container at build time but represented by a Pod at runtime. So what is an application that consists of multiple microservices? Here,Kubernetes offers two more primitives that can help you define the concept of an application: labels and namespaces. We cover namespaces in detail in â€œNamespacesâ€ on page 9.</p><p>æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå¾®æœåŠ¡åœ¨æ„å»ºæ—¶æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œä½†åœ¨è¿è¡Œæ—¶ç”±ä¸€ä¸ªPodè¡¨ç¤ºã€‚é‚£ä¹ˆï¼Œç”±å¤šä¸ªå¾®æœåŠ¡ç»„æˆçš„åº”ç”¨ç¨‹åºæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåœ¨è¿™é‡Œï¼ŒKubernetesæä¾›äº†å¦å¤–ä¸¤ä¸ªåŸè¯­ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æ‚¨å®šä¹‰åº”ç”¨ç¨‹åºçš„æ¦‚å¿µï¼šæ ‡ç­¾å’Œå‘½åç©ºé—´ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ä¸ªæ ‡é¢˜â€œå‘½åç©ºé—´â€ä¸­è¯¦ç»†ä»‹ç»å‘½åç©ºé—´ã€‚</p><p>Before microservices, an application corresponded to a single deployment unit with a single versioning scheme and release cycle. There was a single file for an application in the form of a .war, or .ear or some other packaging format. But then, applications got split into microservices, which are independently developed, released, run,restarted,or scaled.With microservices, the notion of an application diminishes, and there are no longer key artifacts or activities that we have to perform at the application level. However, if you still need a way to indicate that some independent services belong to an application, labels can be used. Letâ€™s imagine that we have split one monolithic application into three microservices, and another application into two microservices.</p><p>åœ¨å¾®æœåŠ¡å‡ºç°ä¹‹å‰ï¼Œæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½å…·æœ‰å•ä¸€ç‰ˆæœ¬æ§åˆ¶æ–¹æ¡ˆå’Œå‘å¸ƒå‘¨æœŸçš„å•ä¸€éƒ¨ç½²å•å…ƒã€‚åº”ç”¨ç¨‹åºåªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œæ ¼å¼ä¸º.warã€æˆ–.earæˆ–å…¶ä»–æ‰“åŒ…æ ¼å¼ã€‚ä½†éšåï¼Œåº”ç”¨ç¨‹åºè¢«æ‹†åˆ†ä¸ºç‹¬ç«‹å¼€å‘ã€å‘å¸ƒã€è¿è¡Œã€å¯ä»¥é‡æ–°å¯åŠ¨æˆ–æ‰©å±•çš„å¾®æœåŠ¡ã€‚æœ‰äº†å¾®æœåŠ¡ï¼Œåº”ç”¨ç¨‹åºçš„æ¦‚å¿µå°±å‡å°‘äº†ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦åœ¨åº”ç”¨ç¨‹åºçº§åˆ«æ‰§è¡Œå…³é”®çš„æ„å»ºå’Œä»»åŠ¡ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ ä»ç„¶éœ€è¦ä¸€ç§æ–¹æ³•æ¥æŒ‡ç¤ºæŸäº›ç‹¬ç«‹æœåŠ¡å±äºæŸä¸ªåº”ç”¨ç¨‹åºï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ ‡ç­¾ã€‚è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬å·²ç»å°†ä¸€ä¸ªå•ç‰‡åº”ç”¨ç¨‹åºæ‹†åˆ†ä¸ºä¸‰ä¸ªå¾®æœåŠ¡ï¼Œå°†å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºæ‹†åˆ†ä¸ºä¸¤ä¸ªå¾®æœåŠ¡ã€‚</p><p>We now have five Pod definitions (and maybe many more Pod instances) that are independent of the development and runtime points of view. However, we may still need to indicate that the first three Pods represent an application and the other two Pods represent another application. Even the Pods may be independent, to provide a business value, but they may depend on each other. For example, one Pod may contain the containers responsible for the frontend, and the other two Pods are responsible for providing the backend functionality. If either of these Pods is down, the application is useless from a business point of view. Using label selectors gives us the ability to query and identify a set of Pods and manage it as one logical unit. Figure 1-3 shows how you can use labels to group the parts of a distributed application into specific subsystems.</p><p>æˆ‘ä»¬ç°åœ¨æœ‰äº”ä¸ªPodå®šä¹‰ï¼ˆå¯èƒ½è¿˜æœ‰æ›´å¤šçš„Podå®ä¾‹ï¼‰ï¼Œçœ‹ä¸Šå»å®ƒä»¬æ˜¯ç‹¬ç«‹äºå¼€å‘å’Œå…·æœ‰å•ç‹¬çš„è¿è¡Œæ—¶ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯èƒ½ä»ç„¶éœ€è¦æŒ‡å‡ºï¼Œå‰ä¸‰ä¸ªpodè¡¨ç¤ºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå¦å¤–ä¸¤ä¸ªpodè¡¨ç¤ºå¦ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚å³ä½¿PODä¹Ÿå¯èƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä»¥æä¾›ä¸šåŠ¡ä»·å€¼ï¼Œä½†å®ƒä»¬å¯èƒ½ç›¸äº’ä¾èµ–ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªPodå¯èƒ½åŒ…å«è´Ÿè´£å‰ç«¯çš„å®¹å™¨ï¼Œå¦å¤–ä¸¤ä¸ªPodè´Ÿè´£æä¾›åç«¯åŠŸèƒ½ã€‚å¦‚æœè¿™äº›Podä¸­çš„ä»»ä½•ä¸€ä¸ªåœæœºï¼Œé‚£ä¹ˆä»ä¸šåŠ¡è§’åº¦æ¥çœ‹ï¼Œåº”ç”¨ç¨‹åºæ˜¯æ— ç”¨çš„ã€‚ä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨ä½¿æˆ‘ä»¬èƒ½å¤ŸæŸ¥è¯¢å’Œè¯†åˆ«ä¸€ç»„PODï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªé€»è¾‘å•å…ƒè¿›è¡Œç®¡ç†ã€‚å›¾1-3æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨æ ‡ç­¾å°†åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„å„ä¸ªéƒ¨åˆ†åˆ†ç»„åˆ°ç‰¹å®šçš„å­ç³»ç»Ÿä¸­ã€‚ <img src="https://cdn.nlark.com/yuque/0/2021/png/2466332/1633507851767-184dafad-a40e-4772-9e75-b246f4239cec.png#clientId=u6d5596df-caa0-4&amp;from=paste&amp;height=718&amp;id=u1ab1c455&amp;margin=[object Object]&amp;name=image.png&amp;originHeight=718&amp;originWidth=1154&amp;originalType=binary&amp;ratio=1&amp;size=159503&amp;status=done&amp;style=none&amp;taskId=u9f9067b4-4db1-48b6-aade-28cee0d539a&amp;width=1154" alt="image.png" loading="lazy"> Figure 1-3. Labels used as an application identity for Pods</p><p>Here are a few examples where labels can be useful:</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›æ ‡ç­¾æœ‰ç”¨çš„ç¤ºä¾‹ï¼š</p><ul><li>Labels are used by the ReplicaSets to keep some instances of a specific Pod running.That means every Pod definition needs to have a unique combination of labels used for scheduling.</li><li>å¤åˆ¶é›†(å‰¯æœ¬é›†ç¾¤)ä½¿ç”¨æ ‡ç­¾æ¥ç¡®ä¿Podçš„æŸäº›å®ä¾‹é«˜å¯ç”¨çš„è¿è¡Œã€‚è¿™æ„å‘³ç€æ¯ä¸ªPodå®šä¹‰éƒ½éœ€è¦ä¸€ä¸ªç”¨äºè°ƒåº¦çš„å”¯ä¸€æ ‡ç­¾ç»„åˆã€‚</li><li>Labels are also used heavily by the scheduler. The scheduler uses labels for colocating or spreading Pods to place Pods on the nodes that satisfy the Podsâ€™ requirements.</li><li>è°ƒåº¦ç¨‹åºä¹Ÿå¤§é‡ä½¿ç”¨æ ‡ç­¾ã€‚è°ƒåº¦å™¨ä½¿ç”¨æ ‡ç­¾å¯¹Podè¿›è¡Œå®šä½æˆ–æ‰©å±•ï¼Œä»¥å°†Podæ”¾ç½®åœ¨æ»¡è¶³Podéœ€æ±‚çš„èŠ‚ç‚¹ä¸Šã€‚</li><li>A Label can indicate a logical grouping of set of Pods and give an application identity to them.</li><li>æ ‡ç­¾å¯ä»¥æŒ‡æ˜ä¸€ç»„PODçš„é€»è¾‘åˆ†ç»„ï¼Œå¹¶ä¸ºå®ƒä»¬æä¾›åº”ç”¨ç¨‹åºæ ‡è¯†ã€‚</li><li>In addition to the preceding typical use cases, labels can be used to store <a href="http://metadata.It" target="_blank" rel="noopener noreferrer">metadata.It<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> may be difficult to predict what a label could be used for, but it is best to have enough labels to describe all important aspects of the Pods. For example,having labels to indicate the logical group of an application, the business characteristics and criticality, the specific runtime platform dependencies such as hardware architecture, or location preferences are all useful. Later, these labels can be used by the scheduler for more fine-grained scheduling,or the same labels can be used from the command line for managing the matching Pods at scale. However, you should not go overboard and add too many labels in advance. You can always add them later if needed. Removing labels is much riskier as there is no straight-forward way of finding out what a label is used for,and what unintended effect such an action may cause.</li><li>é™¤äº†å‰é¢çš„å…¸å‹ç”¨ä¾‹å¤–ï¼Œæ ‡ç­¾è¿˜å¯ç”¨äºå­˜å‚¨å…ƒæ•°æ®ã€‚å¯èƒ½å¾ˆéš¾é¢„æµ‹æ ‡ç­¾çš„ç”¨é€”ï¼Œä½†æœ€å¥½æœ‰è¶³å¤Ÿçš„æ ‡ç­¾æ¥æè¿°PODçš„æ‰€æœ‰é‡è¦æ–¹é¢ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨æ ‡ç­¾æŒ‡ç¤ºåº”ç”¨ç¨‹åºçš„é€»è¾‘ç»„ã€ä¸šåŠ¡ç‰¹å¾å’Œå…³é”®æ€§ã€ç‰¹å®šè¿è¡Œæ—¶å¹³å°ä¾èµ–æ€§ï¼ˆå¦‚ç¡¬ä»¶ä½“ç³»ç»“æ„ï¼‰æˆ–ä½ç½®é¦–é€‰é¡¹éƒ½å¾ˆæœ‰ç”¨ã€‚ ç¨åï¼Œè°ƒåº¦å™¨å¯ä»¥ä½¿ç”¨è¿™äº›æ ‡ç­¾è¿›è¡Œæ›´ç»†ç²’åº¦çš„è°ƒåº¦ï¼Œä¹Ÿå¯ä»¥ä»å‘½ä»¤è¡Œä½¿ç”¨ç›¸åŒçš„æ ‡ç­¾æ¥æŒ‰æ¯”ä¾‹ç®¡ç†åŒ¹é…çš„PODã€‚ä½†æ˜¯ï¼Œä½ ä¸åº”è¯¥è¿‡åº¦ä½¿ç”¨æ ‡ç­¾ï¼Œæå‰æ·»åŠ å¤ªå¤šæ ‡ç­¾ã€‚å¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥éšæ—¶ç¨åæ·»åŠ å®ƒä»¬ã€‚ç§»é™¤æ ‡ç­¾çš„é£é™©æ›´å¤§ï¼Œå› ä¸ºæ²¡æœ‰ç›´æ¥çš„æ–¹æ³•æ¥ç¡®å®šæ ‡ç­¾çš„ç”¨é€”ï¼Œä»¥åŠè¿™æ ·çš„è¡Œä¸ºå¯èƒ½å¯¼è‡´çš„æ„å¤–å½±å“ã€‚</li></ul><h4 id="_1-2-5-annotations" tabindex="-1"><a class="header-anchor" href="#_1-2-5-annotations" aria-hidden="true">#</a> 1.2.5 Annotations</h4><h4 id="_1-2-5-æ³¨é‡Š" tabindex="-1"><a class="header-anchor" href="#_1-2-5-æ³¨é‡Š" aria-hidden="true">#</a> 1.2.5 æ³¨é‡Š</h4><p>Another primitive very similar to labels is called annotations. Like labels, annotations are organized as a map, but they are intended for specifying nonsearchable metadata and for machine usage rather than human.</p><p>å¦ä¸€ä¸ªä¸æ ‡ç­¾éå¸¸ç›¸ä¼¼çš„åŸè¯­ç§°ä¸ºæ³¨é‡Šã€‚ä¸æ ‡ç­¾ä¸€æ ·ï¼Œæ³¨é‡Šè¢«ç»„ç»‡ä¸ºä¸€ä¸ªæ˜ å°„ï¼Œä½†å®ƒä»¬ç”¨äºæŒ‡å®šä¸å¯æ£€ç´¢çš„å…ƒæ•°æ®ï¼Œå¹¶å±äºæœºå™¨ä½¿ç”¨ï¼Œè€Œä¸æ˜¯äººå·¥ä½¿ç”¨ã€‚</p><p>The information on the annotations is not intended for querying and matching objects. Instead, it is intended for attaching additional metadata to objects from various tools and libraries we want to use. Some examples of using annotations include build IDs, release IDs, image information, timestamps, Git branch names, pull request numbers, image hashes, registry addresses, author names, tooling information,and more. So while labels are used primarily for query matching and performing actions on the matching resources, annotations are used to attach metadata that can be consumed by a machine.</p><p>æ³¨é‡Šä¸Šçš„ä¿¡æ¯ä¸ç”¨äºæŸ¥è¯¢å’ŒåŒ¹é…å¯¹è±¡ã€‚ç›¸åï¼Œå®ƒæ—¨åœ¨å°†é™„åŠ å…ƒæ•°æ®é™„åŠ åˆ°æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„å„ç§å·¥å…·å’Œåº“ä¸­çš„å¯¹è±¡ã€‚ä½¿ç”¨æ³¨é‡Šçš„ä¸€äº›ç¤ºä¾‹åŒ…æ‹¬æ„å»ºIDã€å‘å¸ƒIDã€å›¾åƒä¿¡æ¯ã€æ—¶é—´æˆ³ã€Gitåˆ†æ”¯åç§°ã€è¯·æ±‚å·ã€å›¾åƒå“ˆå¸Œã€æ³¨å†Œè¡¨åœ°å€ã€ä½œè€…å§“åã€å·¥å…·ä¿¡æ¯ç­‰ã€‚å› æ­¤ï¼Œè™½ç„¶æ ‡ç­¾ä¸»è¦ç”¨äºæŸ¥è¯¢åŒ¹é…å’Œå¯¹åŒ¹é…èµ„æºæ‰§è¡Œæ“ä½œï¼Œä½†æ³¨é‡Šç”¨äºé™„åŠ æœºå™¨å¯ä»¥ä½¿ç”¨çš„å…ƒæ•°æ®ã€‚</p><h4 id="_1-2-6-namespaces" tabindex="-1"><a class="header-anchor" href="#_1-2-6-namespaces" aria-hidden="true">#</a> 1.2.6 Namespaces</h4><h4 id="_1-2-6-å‘½åç©ºé—´" tabindex="-1"><a class="header-anchor" href="#_1-2-6-å‘½åç©ºé—´" aria-hidden="true">#</a> 1.2.6 å‘½åç©ºé—´</h4><p>Another primitive that can also help in the management of a group of resources is the Kubernetes namespace. As we have described, a namespace may seem similar to a label, but in reality, it is a very different primitive with different characteristics and purpose.</p><p>å¦ä¸€ä¸ªæœ‰åŠ©äºç®¡ç†ä¸€ç»„èµ„æºçš„åŸè¯­æ˜¯Kuberneteså‘½åç©ºé—´ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€æè¿°çš„ï¼Œå‘½åç©ºé—´çœ‹èµ·æ¥å¯èƒ½ç±»ä¼¼äºæ ‡ç­¾ï¼Œä½†å®é™…ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸ä¸åŒçš„åŸè¯­ï¼Œå…·æœ‰ä¸åŒçš„ç‰¹å¾å’Œç”¨é€”ã€‚</p><p>Kubernetes namespaces allow dividing a Kubernetes cluster (which is usually spread across multiple hosts) into a logical pool of resources. Namespaces provide scopes for Kubernetes resources and a mechanism to apply authorizations and other policies to a subsection of the cluster. The most common use case of namespaces is representing different software environments such as development, testing, integration testing, or production.</p><p>Kuberneteså‘½åç©ºé—´å…è®¸å°†Kubernetesé›†ç¾¤ï¼ˆé€šå¸¸åˆ†å¸ƒåœ¨å¤šä¸ªä¸»æœºä¸Šï¼‰åˆ’åˆ†ä¸ºä¸€ä¸ªé€»è¾‘èµ„æºæ± ã€‚å‘½åç©ºé—´ä¸ºKubernetesèµ„æºæä¾›äº†ä½œç”¨åŸŸï¼Œå¹¶æä¾›äº†å°†æˆæƒå’Œå…¶ä»–ç­–ç•¥åº”ç”¨äºé›†ç¾¤å­éƒ¨åˆ†çš„æœºåˆ¶ã€‚å‘½åç©ºé—´æœ€å¸¸è§çš„ç”¨ä¾‹æ˜¯è¡¨ç¤ºä¸åŒçš„è½¯ä»¶ç¯å¢ƒï¼Œå¦‚å¼€å‘ã€æµ‹è¯•ã€é›†æˆæµ‹è¯•æˆ–ç”Ÿäº§ç¯å¢ƒã€‚</p><p>Namespaces can also be used to achieve multitenancy, and provide isolation for team workspaces, projects, and even specific applications. But ultimately, for a greater isolation of certain environments, namespaces are not enough, and having separate clusters is common. Typically, there is one nonproduction Kubernetes cluster used for some environments (development, testing, and integration testing) and another production Kubernetes cluster to represent performance testing and production environments.</p><p>å‘½åç©ºé—´è¿˜å¯ç”¨äºå®ç°å¤šç§Ÿæˆ·ï¼Œå¹¶ä¸ºå›¢é˜Ÿå·¥ä½œç©ºé—´ã€é¡¹ç›®ç”šè‡³ç‰¹å®šåº”ç”¨ç¨‹åºæä¾›éš”ç¦»ã€‚ä½†å½’æ ¹ç»“åº•ï¼Œä¸ºäº†æ›´å¥½åœ°éš”ç¦»æŸäº›ç¯å¢ƒï¼Œå‘½åç©ºé—´æ˜¯ä¸å¤Ÿçš„ï¼Œè€Œæ‹¥æœ‰ç‹¬ç«‹çš„é›†ç¾¤æ˜¯å¾ˆå¸¸è§çš„ã€‚é€šå¸¸ï¼Œæœ‰ä¸€ä¸ªéç”Ÿäº§Kubernetesé›†ç¾¤ç”¨äºæŸäº›ç¯å¢ƒï¼ˆå¼€å‘ã€æµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼‰ï¼Œå¦ä¸€ä¸ªç”Ÿäº§Kubernetesé›†ç¾¤ç”¨äºè¡¨ç¤ºæ€§èƒ½æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒã€‚</p><p>Letâ€™s see some of the characteristics of namespaces and how they can help us in different scenarios:</p><p>è®©æˆ‘ä»¬çœ‹çœ‹å‘½åç©ºé—´çš„ä¸€äº›ç‰¹æ€§ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•åœ¨ä¸åŒçš„åœºæ™¯ä¸­å¸®åŠ©æˆ‘ä»¬ï¼š</p><ul><li>A namespace is managed as a Kubernetes resource.</li><li>å‘½åç©ºé—´ä½œä¸ºKubernetesèµ„æºè¿›è¡Œç®¡ç†ã€‚</li><li>A namespace provides scope for resources such as containers, Pods,Services, or ReplicaSets. The names of resources need to be unique within a namespace, but not across them.</li><li>å‘½åç©ºé—´ä¸ºå®¹å™¨ã€Podã€æœåŠ¡æˆ–å¤åˆ¶é›†ç­‰èµ„æºæä¾›ä½œç”¨åŸŸã€‚èµ„æºçš„åç§°åœ¨å‘½åç©ºé—´å†…å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä½†ä¸èƒ½è·¨å‘½åç©ºé—´ã€‚</li><li>By default, namespaces provide scope for resources, but nothing isolates those resources and prevents access from one resource to another. For example, a Pod from a development namespace can access another Pod from a production namespace as long as the Pod IP address is known. However, there are Kubernetes plugins that provide networking isolation to achieve true multitenancy across namespaces if desired.</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘½åç©ºé—´ä¸ºèµ„æºæä¾›ä½œç”¨åŸŸï¼Œä½†æ²¡æœ‰ä»»ä½•ä¸œè¥¿å¯ä»¥éš”ç¦»è¿™äº›èµ„æºå¹¶é˜»æ­¢ä»ä¸€ä¸ªèµ„æºåˆ°å¦ä¸€ä¸ªèµ„æºçš„è®¿é—®ã€‚ä¾‹å¦‚ï¼Œåªè¦Pod IPåœ°å€å·²çŸ¥ï¼Œæ¥è‡ªå¼€å‘å‘½åç©ºé—´çš„Podå°±å¯ä»¥è®¿é—®æ¥è‡ªç”Ÿäº§å‘½åç©ºé—´çš„å¦ä¸€ä¸ªPodã€‚ç„¶è€Œï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œæœ‰ä¸€äº›Kubernetesæ’ä»¶å¯ä»¥æä¾›ç½‘ç»œéš”ç¦»ä»¥å®ç°è·¨åç§°ç©ºé—´çš„çœŸæ­£å¤šç§Ÿæˆ·ã€‚</li><li>Some other resources such as namespaces themselves, nodes, and PersistentVolumes do not belong to namespaces and should have unique cluster-wide names.</li><li>å…¶ä»–ä¸€äº›èµ„æºï¼ˆå¦‚å‘½åç©ºé—´æœ¬èº«ã€èŠ‚ç‚¹å’ŒPersistentVolumeï¼‰ä¸å±äºå‘½åç©ºé—´ï¼Œåº”è¯¥å…·æœ‰å”¯ä¸€çš„ç¾¤é›†èŒƒå›´çš„åç§°ã€‚</li><li>Each Kubernetes Service belongs to a namespace and gets a corresponding DNS address that has the namespace in the form of &lt; service-name &gt;.&lt; namespacename &gt;.svc.cluster.local. So the namespace name is in the URI of every Service belonging to the given namespace. Thatâ€™s one reason it is vital to name namespaces wisely.</li><li>æ¯ä¸ªKubernetesæœåŠ¡éƒ½å±äºä¸€ä¸ªå‘½åç©ºé—´ï¼Œå¹¶è·å–ç›¸åº”çš„DNSåœ°å€ï¼Œè¯¥åœ°å€çš„å‘½åç©ºé—´æ ¼å¼ä¸º&lt; Service name &gt;&lt; namespacename &gt;.svc.cluster.localã€‚å› æ­¤ï¼Œå‘½åç©ºé—´åç§°ä½äºå±äºç»™å®šå‘½åç©ºé—´çš„æ¯ä¸ªæœåŠ¡çš„URIä¸­ã€‚æ‰€ä»¥å»ä¸ºæ¯ä¸ªå‘½åç©ºé—´è¿›è¡Œè°¨æ…çš„å‘½åæ˜¯è‡³å…³é‡è¦çš„ã€‚</li><li>ResourceQuotas provide constraints that limit the aggregated resource consumption per namespace. With ResourceQuotas, a cluster administrator can control the number of objects per type that are allowed in a namespace. For example, a developer namespace may allow only five ConfigMaps, five Secrets, five Services,five ReplicaSets, five PersistentVolumeClaims, and ten Pods.</li><li>èµ„æºé…é¢æœåŠ¡æä¾›äº†å¯¹æ¯ä¸ªå‘½åç©ºé—´çš„èšåˆèµ„æºæ¶ˆè€—çš„çº¦æŸå’Œé™åˆ¶ã€‚ä½¿ç”¨èµ„æºé…é¢æœåŠ¡ï¼Œç¾¤é›†ç®¡ç†å‘˜å¯ä»¥æ§åˆ¶å‘½åç©ºé—´ä¸­æ¯ç§èµ„æºç±»å‹çš„å¯¹è±¡æ•°ã€‚ä¾‹å¦‚ï¼Œå¼€å‘äººå‘˜å‘½åç©ºé—´å¯èƒ½åªå…è®¸äº”ä¸ªé…ç½®æ˜ å°„ã€äº”ä¸ªæ•æ„Ÿæ•°æ®èµ„æºé›†ã€äº”ä¸ªæœåŠ¡ã€äº”ä¸ªå‰¯æœ¬é›†ã€äº”ä¸ªPersistentVolumeClaimsï¼ˆæŒä¹…åŒ–å®¹é‡å£°æ˜ï¼‰å’Œåä¸ªPODã€‚</li><li>ResourceQuotas can also limit the total sum of computing resources we can request in a given namespace. For example, in a cluster with a capacity of 32 GB RAM and 16 cores, it is possible to allocate half of the resourcesâ€”16 GB RAM and 8 coresâ€”for the production namespace, 8 GB RAM and 4 cores for staging environment, 4 GB RAM and 2 cores for development, and the same amount for testing namespaces. The ability of imposing resource constraints on a group of objects by using namespaces and ResourceQuotas is invaluable.</li><li>èµ„æºé…é¢æœåŠ¡è¿˜å¯ä»¥é™åˆ¶ç»™å®šå‘½åç©ºé—´ä¸­è¯·æ±‚çš„è®¡ç®—èµ„æºæ€»é‡ã€‚ä¾‹å¦‚ï¼Œåœ¨å®¹é‡ä¸º32 GB RAMå’Œ16ä¸ªå†…æ ¸çš„é›†ç¾¤ä¸­ï¼Œå¯ä»¥åˆ†é…ä¸€åŠçš„èµ„æºï¼Œ16 GB RAMå’Œ8ä¸ªå†…æ ¸ç”¨äºç”Ÿäº§å‘½åç©ºé—´ï¼Œ8 GB RAMå’Œ4ä¸ªå†…æ ¸ç”¨äºæš‚å­˜ç¯å¢ƒï¼Œ4 GB RAMå’Œ2ä¸ªå†…æ ¸ç”¨äºå¼€å‘ï¼Œç›¸åŒæ•°é‡çš„èµ„æºç”¨äºæµ‹è¯•å‘½åç©ºé—´ã€‚é€šè¿‡ä½¿ç”¨å‘½åç©ºé—´å’Œèµ„æºé…é¢å¯¹ä¸€ç»„å¯¹è±¡æ–½åŠ èµ„æºçº¦æŸçš„èƒ½åŠ›æ˜¯éå¸¸å®è´µçš„ã€‚</li></ul><h3 id="_1-3-discussion" tabindex="-1"><a class="header-anchor" href="#_1-3-discussion" aria-hidden="true">#</a> 1.3 Discussion</h3><h3 id="_1-3-è®¨è®º" tabindex="-1"><a class="header-anchor" href="#_1-3-è®¨è®º" aria-hidden="true">#</a> 1.3 è®¨è®º</h3><p>Weâ€™ve only briefly covered a few of the main Kubernetes concepts we use in this book.However, there are more primitives used by developers on a day-by-day basis. Forexample, if you create a containerized service, there are collections of Kubernetes objects you can use to reap all the benefits of Kubernetes. Keep in mind, these are only the objects used by application developers to integrate a containerized service into Kubernetes. There are also other concepts used by administrators to enable developers to manage the platform effectively. Figure 1-4 gives an overview of the multitude of Kubernetes resources that are useful for developers.</p><p>æˆ‘ä»¬åœ¨æœ¬ä¹¦ä¸­åªç®€è¦ä»‹ç»äº†Kubernetesçš„å‡ ä¸ªä¸»è¦æ¦‚å¿µï¼Œä½†æ˜¯ï¼Œå¼€å‘äººå‘˜æ¯å¤©éƒ½åœ¨ä½¿ç”¨æ›´å¤šçš„åŸè¯­ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åˆ›å»ºä¸€ä¸ªå®¹å™¨åŒ–æœåŠ¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨Kuberneteså¯¹è±¡çš„é›†åˆæ¥è·å–Kubernetesçš„æ‰€æœ‰å±æ€§å†…å®¹ã€‚è¯·è®°ä½ï¼Œè¿™äº›åªæ˜¯åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ç”¨äºå°†å®¹å™¨åŒ–æœåŠ¡é›†æˆåˆ°Kubernetesä¸­çš„å¯¹è±¡ã€‚ç®¡ç†å‘˜è¿˜ä½¿ç”¨äº†å…¶ä»–æ¦‚å¿µï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæœ‰æ•ˆåœ°ç®¡ç†å¹³å°ã€‚å›¾1-4æ¦‚è¿°äº†å¯¹å¼€å‘äººå‘˜æœ‰ç”¨çš„å¤§é‡Kubernetesèµ„æºã€‚ <img src="https://cdn.nlark.com/yuque/0/2021/png/2466332/1633507900803-fa299476-031f-42e5-b9ca-5a5dfb026048.png#clientId=u6d5596df-caa0-4&amp;from=paste&amp;height=1105&amp;id=ua25c2e71&amp;margin=[object Object]&amp;name=image.png&amp;originHeight=1105&amp;originWidth=1383&amp;originalType=binary&amp;ratio=1&amp;size=154235&amp;status=done&amp;style=none&amp;taskId=u2d341a15-b233-4702-8fed-9c834967ad6&amp;width=1383" alt="image.png" loading="lazy"> Figure 1-4. Kubernetes concepts for developers</p><p>With time, these new primitives give birth to new ways of solving problems, and some of these repetitive solutions become patterns. Throughout this book, rather than describing a Kubernetes resource in detail, we will focus on Kubernetes aspects that are proven as patterns.</p><p>éšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¿™äº›æ–°çš„åŸè¯­äº§ç”Ÿäº†è§£å†³é—®é¢˜çš„æ–°æ–¹æ³•ï¼Œå…¶ä¸­ä¸€äº›é‡å¤çš„è§£å†³æ–¹æ¡ˆæˆä¸ºæ¨¡å¼ã€‚åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»è¢«è¯æ˜æ˜¯æ¨¡å¼çš„Kubernetesæ–¹é¢ï¼Œè€Œä¸æ˜¯è¯¦ç»†æè¿°Kubernetesèµ„æºã€‚</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/Aiyin5/Aiyin5.github.io/edit/main/docs/zh/posts/æ–‡ç« ç¿»è¯‘/K8sæ¨¡å¼/K8sçš„ç®€ä»‹/ç¬¬ä¸€éƒ¨åˆ†K8sç®€ä»‹.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 372020407@qq.com">aiyin</span><!--]--><!--]--></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a href="/about/About">å…³äºç½‘ç«™</a></div><div class="copyright">Copyright Â© 2023 è‰¾å› </div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-3a4486d4.js" defer></script>
  </body>
</html>
